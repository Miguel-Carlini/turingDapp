{"ast":null,"code":"var _jsxFileName = \"/home/miguel/Documentos/moddApptut/src/App.js\",\n    _s = $RefreshSig$();\n\nimport './App.css';\nimport { useEffect, useState, useCallback } from \"react\";\nimport { ethers } from \"ethers\";\nimport TokenArtifact from \"./artifacts/contracts/TuringToken.sol/TuringToken.json\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst contractAddress = \"0x5fbdb2315678afecb367f032d93f642f64180aa3\"; // Endereço do contrato\n\nconst contractABI = TokenArtifact.abi;\nexport default function TuringDapp() {\n  _s();\n\n  const [contract, setContract] = useState(null);\n  const [codename, setCodename] = useState(\"\");\n  const [amount, setAmount] = useState(\"\");\n  const [ranking, setRanking] = useState([]);\n  const [account, setAccount] = useState(null); // Estado para armazenar a conta conectada\n  // Função para conectar ao MetaMask\n\n  const connectMetaMask = async () => {\n    if (window.ethereum) {\n      try {\n        const accounts = await window.ethereum.request({\n          method: \"eth_requestAccounts\"\n        });\n        const web3Provider = new ethers.providers.Web3Provider(window.ethereum);\n        const signer = web3Provider.getSigner();\n        setAccount(accounts[0]);\n        setContract(new ethers.Contract(contractAddress, contractABI, signer));\n      } catch (error) {\n        console.error(\"Erro ao conectar ao MetaMask:\", error);\n        alert(\"Falha ao conectar ao MetaMask. Tente novamente.\");\n      }\n    } else {\n      console.error(\"MetaMask não encontrado. Instale o MetaMask.\");\n      alert(\"MetaMask não encontrado. Instale o MetaMask.\");\n    }\n  };\n\n  useEffect(() => {\n    if (window.ethereum) {\n      const checkAccount = async () => {\n        const accounts = await window.ethereum.request({\n          method: \"eth_accounts\"\n        });\n\n        if (accounts.length > 0) {\n          setAccount(accounts[0]);\n          const web3Provider = new ethers.providers.Web3Provider(window.ethereum);\n          const signer = web3Provider.getSigner();\n          setContract(new ethers.Contract(contractAddress, contractABI, signer));\n        }\n      };\n\n      checkAccount();\n    }\n  }, []);\n  const updateRanking = useCallback(async () => {\n    if (contract) {\n      try {\n        const users = await contract.getAllUsers(); // Certifique-se de que essa função existe no contrato!\n\n        const balances = await Promise.all(users.map(user => contract.balanceOf(user)));\n        const ranked = users.map((user, i) => ({\n          user,\n          balance: balances[i]\n        })).sort((a, b) => b.balance - a.balance);\n        setRanking(ranked);\n      } catch (error) {\n        console.error(\"Erro ao atualizar ranking:\", error);\n      }\n    }\n  }, [contract]);\n  useEffect(() => {\n    if (contract) {\n      const handleVoteCast = (voter, amount) => {\n        console.log(`Vote lançado por ${voter}: ${amount} Turings`);\n        updateRanking();\n      };\n\n      const handleTokenEmitido = (voter, codiname, amount) => {\n        console.log(`Token emitido para ${codiname} por ${voter}: ${ethers.utils.formatUnits(amount, 18)} Turings`);\n      };\n\n      const handleRecompensaEmitida = (voter, amount) => {\n        console.log(`Recompensa de ${ethers.utils.formatUnits(amount, 18)} Turings emitida para ${voter}`);\n      };\n\n      contract.off(\"VotoEmitido\", handleVoteCast); // Remove listener antigo\n\n      contract.on(\"VotoEmitido\", handleVoteCast);\n      contract.off(\"TokenEmitido\", handleTokenEmitido); // Remove listener antigo\n\n      contract.on(\"TokenEmitido\", handleTokenEmitido);\n      contract.off(\"RecompensaEmitida\", handleRecompensaEmitida); // Remove listener antigo\n\n      contract.on(\"RecompensaEmitida\", handleRecompensaEmitida);\n      return () => {\n        contract.off(\"VotoEmitido\", handleVoteCast);\n        contract.off(\"TokenEmitido\", handleTokenEmitido);\n        contract.off(\"RecompensaEmitida\", handleRecompensaEmitida);\n      };\n    }\n  }, [contract, updateRanking]);\n\n  const issueToken = async () => {\n    if (!codename || !amount) {\n      alert(\"Por favor, preencha os campos de Codename e Quantidade.\");\n      return;\n    }\n\n    if (contract && account) {\n      try {\n        const tx = await contract.issueToken(codename, ethers.utils.parseUnits(amount, 18));\n        await tx.wait();\n        alert(\"Token emitido com sucesso!\");\n      } catch (error) {\n        console.error(\"Erro ao emitir token:\", error);\n        alert(\"Falha ao emitir token. Verifique seu saldo e tente novamente.\");\n      }\n    }\n  };\n\n  const vote = async () => {\n    if (!codename || !amount) {\n      alert(\"Por favor, preencha os campos de Codename e Quantidade.\");\n      return;\n    }\n\n    if (contract && account) {\n      try {\n        const tx = await contract.vote(codename, ethers.utils.parseUnits(amount, 18));\n        await tx.wait();\n        alert(\"Voto registrado com sucesso!\");\n      } catch (error) {\n        console.error(\"Erro ao votar:\", error);\n        alert(\"Falha ao votar. Verifique seu saldo e tente novamente.\");\n      }\n    }\n  };\n\n  const votingOn = async () => {\n    if (contract && account) {\n      try {\n        const tx = await contract.votingOn();\n        await tx.wait();\n        alert(\"Votação ativada!\");\n      } catch (error) {\n        console.error(\"Erro ao ativar votação:\", error);\n        alert(\"Erro ao ativar a votação. Tente novamente.\");\n      }\n    }\n  };\n\n  const votingOff = async () => {\n    if (contract && account) {\n      try {\n        const votingStatus = await contract.votingEnabled();\n\n        if (!votingStatus) {\n          alert(\"A votação já está desativada.\");\n          return;\n        }\n\n        const tx = await contract.votingOff();\n        await tx.wait();\n        alert(\"Votação desativada!\");\n      } catch (error) {\n        console.error(\"Erro ao desativar votação:\", error);\n        alert(\"Erro ao desativar a votação. Tente novamente.\");\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6 max-w-3xl mx-auto\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-bold mb-4\",\n      children: \"Turing Token DApp\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }, this), !account ? /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: connectMetaMask,\n      className: \"px-4 py-2 bg-blue-500 text-white rounded\",\n      children: \"Conectar ao MetaMask\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Conta conectada:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 24\n        }, this), \" \", account]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Codename\",\n        value: codename,\n        onChange: e => setCodename(e.target.value),\n        className: \"p-2 border rounded w-full mb-2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Quantidade\",\n        value: amount,\n        onChange: e => setAmount(e.target.value),\n        className: \"p-2 border rounded w-full\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-wrap gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: issueToken,\n        className: \"px-4 py-2 bg-blue-500 text-white rounded\",\n        children: \"Emitir Token\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: vote,\n        className: \"px-4 py-2 bg-green-500 text-white rounded\",\n        children: \"Votar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: votingOn,\n        className: \"px-4 py-2 bg-yellow-500 text-white rounded\",\n        children: \"Ativar Vota\\xE7\\xE3o\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: votingOff,\n        className: \"px-4 py-2 bg-red-500 text-white rounded\",\n        children: \"Desativar Vota\\xE7\\xE3o\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-semibold\",\n        children: \"Ranking\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: ranking.map((entry, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [entry.user, \": \", ethers.utils.formatUnits(entry.balance, 18), \" Turings\"]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 168,\n    columnNumber: 9\n  }, this);\n}\n\n_s(TuringDapp, \"2HQsxaT8oyHd4rQ2K6JUZvplcHI=\");\n\n_c = TuringDapp;\n\nvar _c;\n\n$RefreshReg$(_c, \"TuringDapp\");","map":{"version":3,"sources":["/home/miguel/Documentos/moddApptut/src/App.js"],"names":["useEffect","useState","useCallback","ethers","TokenArtifact","contractAddress","contractABI","abi","TuringDapp","contract","setContract","codename","setCodename","amount","setAmount","ranking","setRanking","account","setAccount","connectMetaMask","window","ethereum","accounts","request","method","web3Provider","providers","Web3Provider","signer","getSigner","Contract","error","console","alert","checkAccount","length","updateRanking","users","getAllUsers","balances","Promise","all","map","user","balanceOf","ranked","i","balance","sort","a","b","handleVoteCast","voter","log","handleTokenEmitido","codiname","utils","formatUnits","handleRecompensaEmitida","off","on","issueToken","tx","parseUnits","wait","vote","votingOn","votingOff","votingStatus","votingEnabled","e","target","value","entry","index"],"mappings":"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","sourcesContent":["import './App.css';\nimport { useEffect, useState, useCallback } from \"react\";\nimport { ethers } from \"ethers\";\nimport TokenArtifact from \"./artifacts/contracts/TuringToken.sol/TuringToken.json\";\n\nconst contractAddress = \"0x5fbdb2315678afecb367f032d93f642f64180aa3\"; // Endereço do contrato\nconst contractABI = TokenArtifact.abi;\n\nexport default function TuringDapp() {\n    const [contract, setContract] = useState(null);\n    const [codename, setCodename] = useState(\"\");\n    const [amount, setAmount] = useState(\"\");\n    const [ranking, setRanking] = useState([]);\n    const [account, setAccount] = useState(null); // Estado para armazenar a conta conectada\n\n    // Função para conectar ao MetaMask\n    const connectMetaMask = async () => {\n        if (window.ethereum) {\n            try {\n                const accounts = await window.ethereum.request({ method: \"eth_requestAccounts\" });\n                const web3Provider = new ethers.providers.Web3Provider(window.ethereum);\n                const signer = web3Provider.getSigner();\n                setAccount(accounts[0]);\n                setContract(new ethers.Contract(contractAddress, contractABI, signer));\n            } catch (error) {\n                console.error(\"Erro ao conectar ao MetaMask:\", error);\n                alert(\"Falha ao conectar ao MetaMask. Tente novamente.\");\n            }\n        } else {\n            console.error(\"MetaMask não encontrado. Instale o MetaMask.\");\n            alert(\"MetaMask não encontrado. Instale o MetaMask.\");\n        }\n    };\n\n    useEffect(() => {\n        if (window.ethereum) {\n            const checkAccount = async () => {\n                const accounts = await window.ethereum.request({ method: \"eth_accounts\" });\n                if (accounts.length > 0) {\n                    setAccount(accounts[0]);\n                    const web3Provider = new ethers.providers.Web3Provider(window.ethereum);\n                    const signer = web3Provider.getSigner();\n                    setContract(new ethers.Contract(contractAddress, contractABI, signer));\n                }\n            };\n            checkAccount();\n        }\n    }, []);\n\n    const updateRanking = useCallback(async () => {\n        if (contract) {\n            try {\n                const users = await contract.getAllUsers(); // Certifique-se de que essa função existe no contrato!\n                const balances = await Promise.all(users.map(user => contract.balanceOf(user)));\n\n                const ranked = users.map((user, i) => ({\n                    user,\n                    balance: balances[i]\n                })).sort((a, b) => b.balance - a.balance);\n\n                setRanking(ranked);\n            } catch (error) {\n                console.error(\"Erro ao atualizar ranking:\", error);\n            }\n        }\n    }, [contract]);\n\n    useEffect(() => {\n        if (contract) {\n            const handleVoteCast = (voter, amount) => {\n                console.log(`Vote lançado por ${voter}: ${amount} Turings`);\n                updateRanking();\n            };\n\n            const handleTokenEmitido = (voter, codiname, amount) => {\n                console.log(`Token emitido para ${codiname} por ${voter}: ${ethers.utils.formatUnits(amount, 18)} Turings`);\n            };\n\n            const handleRecompensaEmitida = (voter, amount) => {\n                console.log(`Recompensa de ${ethers.utils.formatUnits(amount, 18)} Turings emitida para ${voter}`);\n            };\n\n            contract.off(\"VotoEmitido\", handleVoteCast); // Remove listener antigo\n            contract.on(\"VotoEmitido\", handleVoteCast);\n\n            contract.off(\"TokenEmitido\", handleTokenEmitido); // Remove listener antigo\n            contract.on(\"TokenEmitido\", handleTokenEmitido);\n\n            contract.off(\"RecompensaEmitida\", handleRecompensaEmitida); // Remove listener antigo\n            contract.on(\"RecompensaEmitida\", handleRecompensaEmitida);\n\n            return () => {\n                contract.off(\"VotoEmitido\", handleVoteCast);\n                contract.off(\"TokenEmitido\", handleTokenEmitido);\n                contract.off(\"RecompensaEmitida\", handleRecompensaEmitida);\n            };\n        }\n    }, [contract, updateRanking]);\n\n    const issueToken = async () => {\n        if (!codename || !amount) {\n            alert(\"Por favor, preencha os campos de Codename e Quantidade.\");\n            return;\n        }\n        \n        if (contract && account) {\n            try {\n                const tx = await contract.issueToken(codename, ethers.utils.parseUnits(amount, 18));\n                await tx.wait();\n                alert(\"Token emitido com sucesso!\");\n            } catch (error) {\n                console.error(\"Erro ao emitir token:\", error);\n                alert(\"Falha ao emitir token. Verifique seu saldo e tente novamente.\");\n            }\n        }\n    };\n\n    const vote = async () => {\n        if (!codename || !amount) {\n            alert(\"Por favor, preencha os campos de Codename e Quantidade.\");\n            return;\n        }\n\n        if (contract && account) {\n            try {\n                const tx = await contract.vote(codename, ethers.utils.parseUnits(amount, 18));\n                await tx.wait();\n                alert(\"Voto registrado com sucesso!\");\n            } catch (error) {\n                console.error(\"Erro ao votar:\", error);\n                alert(\"Falha ao votar. Verifique seu saldo e tente novamente.\");\n            }\n        }\n    };\n\n    const votingOn = async () => {\n        if (contract && account) {\n            try {\n                const tx = await contract.votingOn();\n                await tx.wait();\n                alert(\"Votação ativada!\");\n            } catch (error) {\n                console.error(\"Erro ao ativar votação:\", error);\n                alert(\"Erro ao ativar a votação. Tente novamente.\");\n            }\n        }\n    };\n\n    const votingOff = async () => {\n        if (contract && account) {\n            try {\n                const votingStatus = await contract.votingEnabled(); \n                if (!votingStatus) {\n                    alert(\"A votação já está desativada.\");\n                    return;\n                }\n                const tx = await contract.votingOff();\n                await tx.wait();\n                alert(\"Votação desativada!\");\n            } catch (error) {\n                console.error(\"Erro ao desativar votação:\", error);\n                alert(\"Erro ao desativar a votação. Tente novamente.\");\n            }\n        }\n    };    \n\n    return (\n        <div className=\"p-6 max-w-3xl mx-auto\">\n            <h2 className=\"text-2xl font-bold mb-4\">Turing Token DApp</h2>\n\n            {!account ? (\n                <button\n                    onClick={connectMetaMask}\n                    className=\"px-4 py-2 bg-blue-500 text-white rounded\"\n                >\n                    Conectar ao MetaMask\n                </button>\n            ) : (\n                <div>\n                    <p><strong>Conta conectada:</strong> {account}</p>\n                </div>\n            )}\n\n            <div className=\"mb-4\">\n                <input\n                    type=\"text\"\n                    placeholder=\"Codename\"\n                    value={codename}\n                    onChange={(e) => setCodename(e.target.value)}\n                    className=\"p-2 border rounded w-full mb-2\"\n                />\n                <input\n                    type=\"text\"\n                    placeholder=\"Quantidade\"\n                    value={amount}\n                    onChange={(e) => setAmount(e.target.value)}\n                    className=\"p-2 border rounded w-full\"\n                />\n            </div>\n\n            <div className=\"flex flex-wrap gap-4\">\n                <button onClick={issueToken} className=\"px-4 py-2 bg-blue-500 text-white rounded\">\n                    Emitir Token\n                </button>\n                <button onClick={vote} className=\"px-4 py-2 bg-green-500 text-white rounded\">\n                    Votar\n                </button>\n                <button onClick={votingOn} className=\"px-4 py-2 bg-yellow-500 text-white rounded\">\n                    Ativar Votação\n                </button>\n                <button onClick={votingOff} className=\"px-4 py-2 bg-red-500 text-white rounded\">\n                    Desativar Votação\n                </button>\n            </div>\n\n            <div className=\"mt-6\">\n                <h3 className=\"text-lg font-semibold\">Ranking</h3>\n                <ul>\n                    {ranking.map((entry, index) => (\n                        <li key={index}>\n                            {entry.user}: {ethers.utils.formatUnits(entry.balance, 18)} Turings\n                        </li>\n                    ))}\n                </ul>\n            </div>\n        </div>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}